#===============================================================================
DOSE  = 0.688456  # nanoGrey
#DOSE  = 5.320810  # nanoGrey
#DOSE  = 0.405764  # nanoGrey
#DOSE  = 0.291349  # nanoGrey
N_DEC =   3750000. # simulated number of decays
N_TOT = 750000000. # source activity
cu_density = 8960  # kg/m3
r_disk     =  0.3  # 300 mm
s_disk     =  0.0115  # 23 mm dismeter mm
h_disk     =  0.035 /1000. ; # 35 um
MeV_to_pJ = 0.160217766 ;
#===============================================================================
import shelve
import numpy as np
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import matplotlib.mlab   as mlab
from math import pow, sqrt, pi, cos, sin
from scipy.signal import savgol_filter
#===============================================================================
ds = [0.1, 0.6000000000000001, 1.1, 1.6, 2.1, 2.6, 3.1, 3.6, 4.1000000000000005, 4.6000000000000005, 5.1000000000000005, 5.6000000000000005, 6.1000000000000005, 6.6000000000000005, 7.1000000000000005, 7.6000000000000005, 8.1, 8.6, 9.1, 9.600000000000001, 10.100000000000001, 10.600000000000001, 11.100000000000001, 11.600000000000001, 12.100000000000001, 12.600000000000001, 13.100000000000001, 13.600000000000001, 14.100000000000001, 14.600000000000001, 15.100000000000001, 15.600000000000001, 16.1, 16.6, 17.1, 17.6, 18.1, 18.6, 19.1, 19.6]
v1 = [0.24024513482389248, 0.21869625482208496, 0.1433410967657476, 0.04702374926452708, 0.0201608544865021, 0.010887067850730884, 0.006928238725610871, 0.004340935739663909, 0.0034515053607099234, 0.00244668693901163, 0.0020673352128686884, 0.0014435442883328669, 0.0012370186933973839, 0.001042043607553436, 0.0009198725884307221, 0.0008663613888326477, 0.0006568606438720669, 0.0005887252150881857, 0.0004501235517376601, 0.00034374200610128117, 0.0002953528021748124, 0.0002132348735500857, 0.00023936655109746917, 0.000218898630505287, 0.00019401467654304083, 0.0001739584110415483, 0.0001344103854663945, 0.0001311043503955011, 0.00010643769355569363, 0.00010921328542143495, 9.562631790882165e-05, 8.82857018647601e-05, 7.907923086594108e-05, 5.658363598354746e-05, 4.4460421917537784e-05, 5.4800558520260156e-05, 4.7553055487584705e-05, 4.2786190297899746e-05, 3.8798046791430977e-05, 2.937862724753003e-05]
v2 = [3.020710645831613, 2.9853348620154874, 2.0802977450399798, 0.09741696628040739, 0.05268200166575853, 0.03184533979120131, 0.020150863689068998, 0.012751387652310518, 0.009313693451536119, 0.006641390626837815, 0.005032136459390459, 0.00371326779062814, 0.003252900961726383, 0.002568892608619949, 0.002312122801249818, 0.0019991501175934735, 0.0017901562967363649, 0.0014729330206432443, 0.0012878513841781865, 0.0010797310595436922, 0.0007604960837870798, 0.0006193396211958164, 0.0006215816102246697, 0.0006153769209428366, 0.0005564392886581729, 0.00048669349859030854, 0.0003988559041772606, 0.0003333714767804329, 0.0003059161100528112, 0.0002178285590145937, 0.00020582205014388238, 0.00020394217677100965, 0.00016417652545311142, 0.00017598393786617735, 0.00019434175630596087, 0.00014440585590236882, 0.00014430539813815524, 0.00013193022121885413, 9.664171078416862e-05, 0.00011740816319856339]
v3 = [0.20476018724320094, 0.1955312549439434, 0.12997734347999013, 0.01792435766818506, 0.007368049998724496, 0.00352580496384922, 0.0020510813237193115, 0.0014298290550154038, 0.0010659191030394487, 0.0008115615711668313, 0.0006449068416922722, 0.00048190214258068547, 0.00028751728537129007, 0.0002249314238735384, 0.0002045269671497579, 0.00018863625781552815, 0.0001696498079066474, 0.0001600056248073985, 0.0001400133179966605, 0.00010141848651548469, 7.094833454734309e-05, 7.367256680865262e-05, 4.833910097228242e-05, 4.1223626084578836e-05, 3.622382253525698e-05, 3.199226034501911e-05, 2.3152532795098416e-05, 2.048522153664541e-05, 2.4546789127907162e-05, 3.311482604207788e-05, 3.75724566003243e-05, 3.2977826245385213e-05, 2.682555819240557e-05, 2.2571982904731684e-05, 2.1091272792270223e-05, 2.800421841985842e-05, 1.9012041616496663e-05, 1.3212834089927589e-05, 7.474203406602251e-06, 8.824289858258229e-06]
v4 = [0.048393658970037494, 0.04350998154612078, 0.030870788263527328, 0.01543418470117601, 0.009592237486603393, 0.007080129852698226, 0.0047357822583796675, 0.003558850379866721, 0.0025888633780011363, 0.0021492067831876635, 0.0016870831943966568, 0.0013573437948323237, 0.001074106223506586, 0.000876027527768899, 0.0006269583294593603, 0.0005489874931078673, 0.0004669337631896405, 0.0004926459451383499, 0.00042321228710173487, 0.00037029938675987417, 0.00025588098855992754, 0.00021369615154192157, 0.00016882078173565562, 0.00015959438251074158, 0.00014087374009784227, 0.00013182442041472121, 0.00011601299573841063, 9.895199746643567e-05, 9.96829760039633e-05, 7.8174543436203e-05, 6.156553120892819e-05, 5.5877158601792765e-05, 3.581207922645043e-05, 3.6265278448511934e-05, 3.563973381113667e-05, 4.561047937964257e-05, 4.343390629358978e-05, 3.140694260009901e-05, 2.4460678562898463e-05, 1.8134250667628177e-05]

v2a = [1.403508601210631, 1.2662796870811128, 0.8296590022124722, 0.26304512535734653, 0.11614534568024733, 0.05474789007710233, 0.032754422001129775, 0.019474885449376304, 0.013690637071702302, 0.008660183780608044, 0.006384269667469455, 0.005283560967548552, 0.004071333650272846, 0.0032927810380610346, 0.002552387524585145, 0.002229753754585607, 0.0018932790326892574, 0.0015766679199688228, 0.0012547971028055815, 0.001005704254600118, 0.0008658841968922575, 0.0007750281285099934, 0.0007556685987514602, 0.000588231601142743, 0.0005965103802792406, 0.000492699131509777, 0.0003894257064905557, 0.00033371654534216646, 0.00042639694225583185, 0.0003196526874267743, 0.0003349964819715379, 0.0002763021980261361, 0.00020568778512252106, 0.00019839180016837328, 0.00013432485861351819, 0.0001391791503064886, 0.00013423104329713065, 0.00012919688828319707, 0.00013864783602951297, 0.00010650266290212306]
v3a = [0.08210501127474452, 0.07550192931065003, 0.051722755454887956, 0.021115369341200167, 0.011667584375586026, 0.00751591214018031, 0.004490788280909875, 0.0028273006093446546, 0.002224377578817083, 0.0015585068266225695, 0.0012783493349997769, 0.0010539534717039082, 0.0008396121121370424, 0.0005449579996504847, 0.00046933369044724896, 0.00033054021719782287, 0.0002584471289861802, 0.0002587506611244869, 0.00021169410818896658, 0.00019757564815236296, 0.00019991289363715148, 0.00016184641528352176, 0.0001390709431712045, 9.125489409724125e-05, 9.365543290747999e-05, 8.700141068942401e-05, 6.319354157403406e-05, 4.5695170093814646e-05, 4.300249091609093e-05, 5.5928511778904334e-05, 5.048199808680604e-05, 5.019965318580843e-05, 5.0547403549552155e-05, 5.195858158849768e-05, 3.432900880167802e-05, 3.320145117914242e-05, 3.072984342750609e-05, 2.0018930897771204e-05, 2.0455602245335622e-05, 1.4246435172908536e-05]

#===============================================================================

plt.plot(ds, v2a, "ro")
plt.plot(ds, v3a, "gs")

#v2h = savgol_filter(v2, 7, 4) # window size 51, polynomial order 3
#v1h = savgol_filter(v1, 7, 4) # window size 51, polynomial order 3
#plt.plot(ds, v2h, "r--")
#plt.plot(ds, v1h, "b--")

plt.xlabel('Distance, cm')
plt.ylabel('Dose rate, microGy / s')
plt.grid(True)
plt.yscale('log')
plt.savefig("FIN.png")
